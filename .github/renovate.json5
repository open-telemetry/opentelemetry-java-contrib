{
  $schema: 'https://docs.renovatebot.com/renovate-schema.json',
  extends: [
    'config:best-practices',
    'helpers:pinGitHubActionDigestsToSemver',
    'customManagers:githubActionsVersions',
  ],
  ignorePaths: [], // overwrite default ignore which includes **/test/**
                   // used to update docker image versions used in Java test files
  ignorePresets: [
    ':ignoreModulesAndTests', // needed to keep maven-extension test pom files up-to-date
    'workarounds:javaLTSVersions', // Allow all Java major versions, not just LTS
  ],
  prHourlyLimit: 5, // we have a large number of parallel runners
  labels: [
    'dependencies',
  ],
  packageRules: [
    {
      // reduces the number of Renovate PRs
      // (patch updates are typically non-breaking)
      groupName: 'all patch versions',
      matchUpdateTypes: [
        'patch',
      ],
      schedule: [
        'before 8am every weekday',
      ],
    },
    {
      // avoids these Renovate PRs from trickling in throughout the week
      // (consolidating the review process)
      matchUpdateTypes: [
        'minor',
        'major',
      ],
      schedule: [
        'before 8am on Monday',
      ],
      matchPackageNames: [
        '!io.opentelemetry:**',
        '!io.opentelemetry.*:**',
      ],
    },
    {
      matchPackageNames: [
        'io.opentelemetry:**',
        'io.opentelemetry.instrumentation:**',
        'io.opentelemetry.semconv:**',
        'io.opentelemetry.proto:**',
      ],
      // Renovate's default behavior is only to update from unstable -> unstable if it's for the
      // major.minor.patch, under the assumption that you would want to update to the stable version
      // of that release instead of the unstable version for a future release
      ignoreUnstable: false,
    },
    {
      // prevent 3.0.1u2 -> 3.0.1
      matchPackageNames: [
        'com.google.code.findbugs:annotations',
      ],
      allowedVersions: '!/^3\\.0\\.1$/',
    },
    {
      // disruptor 4+ requires Java 11+
      matchFileNames: [
        'inferred-spans/build.gradle.kts',
      ],
      matchPackageNames: [
        'com.lmax:disruptor',
      ],
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
    },
    {
      // junit 6+ requires Java 17+
      matchPackageNames: [
        'org.junit:**',
        'org.junit.jupiter:**',
      ],
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
    },
    {
      // caffeine 3+ requires Java 11+
      matchFileNames: [
        'aws-xray/build.gradle.kts',
      ],
      matchPackageNames: [
        'com.github.ben-manes.caffeine:caffeine',
      ],
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
    },
    {
      // junit-pioneer 2+ requires Java 11+
      matchPackageNames: [
        'org.junit-pioneer:junit-pioneer',
      ],
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
    },
    {
      // mockito 5+ requires Java 11+
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
      matchPackageNames: [
        'org.mockito:**',
      ],
    },
    {
      // agrona 1.23+ requires Java 17+
      matchFileNames: [
        'inferred-spans/build.gradle.kts',
      ],
      matchPackageNames: [
        'org.agrona:agrona',
      ],
      matchUpdateTypes: [
        'major',
        'minor',
      ],
      enabled: false,
    },
    {
      // system-stubs-jupiter 2.1+ requires Java 11+
      matchPackageNames: [
        'uk.org.webcompere:system-stubs-jupiter',
      ],
      matchUpdateTypes: [
        'major',
        'minor',
      ],
      enabled: false,
    },
    {
      // pinned version for compatibility
      matchFileNames: [
        'micrometer-meter-provider/build.gradle.kts',
      ],
      matchPackageNames: [
        'io.micrometer:micrometer-core',
      ],
      matchCurrentVersion: '1.5.0',
      enabled: false,
    },
    {
      // pinned version for compatibility
      matchFileNames: [
        'maven-extension/build.gradle.kts',
      ],
      matchCurrentVersion: '3.5.0',
      enabled: false,
      matchPackageNames: [
        'org.apache.maven:**',
      ],
    },
    {
      groupName: 'spotless packages',
      matchPackageNames: [
        'com.diffplug.spotless',
        'com.diffplug.spotless:**',
      ],
    },
    {
      groupName: 'hipparchus packages',
      matchPackageNames: [
        'org.hipparchus:**',
      ],
    },
    {
      groupName: 'errorprone packages',
      matchPackageNames: [
        'com.google.errorprone:**',
      ],
    },
    {
      groupName: 'jackson packages',
      matchPackageNames: [
        'com.fasterxml.jackson:**',
        'com.fasterxml.jackson.core:**',
      ],
    },
    {
      groupName: 'develocity packages',
      matchPackageNames: [
        'com.gradle.develocity:**',
      ],
    },
    {
      groupName: 'bouncycastle packages',
      matchPackageNames: [
        'org.bouncycastle:**',
      ],
    },
    {
      // pinned version for compatibility with java 8 JFR parsing
      matchFileNames: [
        'jfr-connection/build.gradle.kts',
      ],
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
      matchPackageNames: [
        'org.openjdk.jmc:**',
      ],
    },
    {
      // pinned version for compatibility
      matchFileNames: [
        'jmx-scraper/test-webapp/build.gradle.kts',
      ],
      matchCurrentVersion: '5.0.0',
      enabled: false,
      matchPackageNames: [
        'jakarta.servlet:**',
      ],
    },
    {
      // intentionally using Spring Boot 2 in gcp-auth-extension in order to test with Java 8+
      matchFileNames: [
        'gcp-auth-extension/build.gradle.kts',
      ],
      matchUpdateTypes: [
        'major',
      ],
      enabled: false,
      matchPackageNames: [
        'org.springframework.boot:**',
      ],
    },
  ],
  customManagers: [
    {
      customType: 'regex',
      datasourceTemplate: 'npm',
      managerFilePatterns: [
        '.github/workflows/**',
      ],
      matchStrings: [
        'npx (?<depName>[^@]+)@(?<currentValue>[^\\s]+)',
      ],
    },
    {
      customType: 'regex',
      datasourceTemplate: 'java-version',
      managerFilePatterns: [
        '.github/workflows/**',
      ],
      matchStrings: [
        '(?<currentValue>\\d+) # renovate\\(java-version\\)',
      ],
      depNameTemplate: 'java',
      extractVersionTemplate: '^(?<version>\\d+)',
    },
    {
      customType: 'regex',
      datasourceTemplate: 'github-releases',
      managerFilePatterns: [
        '**/build.gradle.kts',
      ],
      matchStrings: [
        '"(?<currentValue>.+?)" // renovate\\(github-releases\\): (?<depName>[^\\s]+)',
      ],
      versioningTemplate: 'semver',
    },
    {
      customType: 'regex',
      datasourceTemplate: 'docker',
      managerFilePatterns: [
        '**/*.java',
      ],
      matchStrings: [
        '"(?<depName>otel/opentelemetry-collector-contrib):(?<currentValue>[^@"]+)(?:@(?<currentDigest>sha256:[a-f0-9]+))?"',
      ],
      autoReplaceStringTemplate: '"{{depName}}:{{newValue}}{{#if newDigest}}@{{newDigest}}{{/if}}"',
      versioningTemplate: 'docker',
    },
  ],
}
